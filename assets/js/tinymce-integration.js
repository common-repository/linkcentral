(()=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n(e)}!function(){function e(e){"object"===("undefined"==typeof linkcentral_tinymce_data?"undefined":n(linkcentral_tinymce_data))?(e.PluginManager.add("linkcentral",(function(n,e){var t,a=linkcentral_tinymce_data.plugin_url+"assets/images/linkcentral-logo.svg";function i(n){var e=n.selection.getNode(),t=n.dom.getParent(e,"a[data-linkcentral-id-sync]");t&&n.selection.select(t);var a={newTab:!1,insertAsShortcode:!1,parameters:""};t&&(a.newTab="_blank"===t.getAttribute("target"),a.parameters=t.getAttribute("data-linkcentral-parameters")||"",a.linkId=t.getAttribute("data-linkcentral-id-sync"));var i=t?"synchronized":linkcentral_tinymce_data.default_link_insertion_type||"synchronized";n.windowManager.open({title:t?"Edit LinkCentral Link":"Insert LinkCentral Link",body:[{type:"container",name:"searchContainer",html:'<div style="position: relative;"><input type="text" id="linkcentral-search" placeholder="Search for a link" style="width: 100%; box-sizing: border-box; padding: 8px; border: 1px solid #ccc; background-color: #fff; border-radius: 4px; margin-bottom: 2px;"><div id="linkcentral-search-results" style="display:none; position: absolute; z-index: 1000; width: 100%; max-height: 200px; overflow-y: auto; border: 1px solid #ccc; background-color: white; margin-top: 5px;"></div></div>'},{type:"checkbox",name:"newTab",label:"New tab:",checked:a.newTab},{type:linkcentral_tinymce_data.can_use_premium_code__premium_only?"textbox":"container",name:"parameters",label:"Parameters:",html:linkcentral_tinymce_data.can_use_premium_code__premium_only?"":'<a href="admin.php?page=linkcentral-settings#premium" target="_blank" class="linkcentral-premium-tag">Premium</a>',value:a.parameters,tooltip:"Add parameters to the link (e.g., param1=value1&param2=value2)"},{type:"container",name:"linkInsertionType",html:'\n                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">\n                                    <label>Link Insertion Type:</label>\n                                    <a href="https://designforwp.com/docs/linkcentral/creating-and-using-links/inserting-links-into-your-content/" target="_blank" style="text-decoration: none; color: #12668A;font-weight: bold;">What is this?</a>\n                                </div>\n                                <div id="link-insertion-type-container" style="display: flex; gap: 10px; margin-bottom: 10px;">\n                                    '.concat(["synchronized","direct","shortcode"].map((function(e){return'\n                                        <div \n                                            data-type="'.concat(e,'"\n                                            style="\n                                                cursor: ').concat("shortcode"===e&&"core/button"===n.name?"not-allowed":"pointer",";\n                                                padding: 10px;\n                                                border: ").concat(i===e?"2px solid #12668A":"2px solid #ccc",";\n                                                border-radius: 4px;\n                                                text-align: center;\n                                                background-color: ").concat(i===e?"#e0f7fa":"#f9f9f9",";\n                                                flex: 1;\n                                                display: flex;\n                                                flex-direction: column;\n                                                align-items: center;\n                                                justify-content: center;\n                                                opacity: ").concat("shortcode"===e&&"core/button"===n.name?.5:1,';\n                                            "\n                                        >\n                                            <i class="mce-ico mce-i-').concat("synchronized"===e?"reload":"direct"===e?"link":"code",'" style="font-size: 20px; margin-bottom: 5px;"></i>\n                                            <span>').concat(e.charAt(0).toUpperCase()+e.slice(1),"</span>\n                                        </div>\n                                    ")})).join(""),"\n                                </div>\n                            ")}],onsubmit:function(e){!function(n,e,t){var a=JSON.parse(n.windowManager.getWindows()[0].selectedLink),i=n.selection.getContent({format:"text"})||a.title;n.undoManager.transact((function(){if("shortcode"===t){var o='[linkcentral id="'+a.id+'"';e.newTab&&(o+=' newtab="true"'),e.parameters&&(o+=' parameters="'+e.parameters+'"'),o+="]"+i+"[/linkcentral]",n.insertContent(o)}else if("direct"===t){var r=a.slug,l=linkcentral_tinymce_data.site_url+"/"+linkcentral_tinymce_data.url_prefix+"/"+r;e.parameters&&(l+=l.includes("?")?"&":"?",l+=e.parameters);var c='<a href="'+l+'"';e.newTab&&(c+=' target="_blank"');var s=["yes"===a.nofollow||"default"===a.nofollow&&a.global_nofollow?"nofollow":"","yes"===a.sponsored||"default"===a.sponsored&&a.global_sponsored?"sponsored":""].filter(Boolean).join(" ");s&&(c+=' rel="'+s+'"');var d="replace"===a.css_classes_option?a.custom_css_classes:"".concat(a.global_css_classes||""," ").concat(a.custom_css_classes||"").trim();d&&(c+=' class="'+d+'"'),c+=">"+i+"</a>",n.selection.setContent(c)}else{var u='<a href="#linkcentral" class="linkcentral-link" data-linkcentral-id-sync="'+a.id+'"';e.newTab&&(u+=' target="_blank"'),e.parameters&&(u+=' data-linkcentral-parameters="'+e.parameters+'"'),u+=">"+i+"</a>",n.selection.setContent(u)}}))}(n,e.data,i)},width:400,height:250}),setTimeout((function(){var n=document.getElementById("link-insertion-type-container");n&&n.addEventListener("click",(function(e){var t=e.target.closest("div[data-type]");t&&"not-allowed"!==t.style.cursor&&(i=t.getAttribute("data-type"),Array.from(n.children).forEach((function(n){n.style.border="2px solid #ccc",n.style.backgroundColor="#f9f9f9"})),t.style.border="2px solid #12668A",t.style.backgroundColor="#e0f7fa")}))}),100),setTimeout((function(){var n=document.getElementById("linkcentral-search");n&&n.focus()}),0),setTimeout((function(){var n,e,t,i,r=document.getElementById("linkcentral-search");r&&(a.linkId&&(r.disabled=!0,t=a.linkId,i=function(n){r.disabled=!1,n&&(r.value=n.title,o(n))},jQuery.ajax({url:linkcentral_tinymce_data.ajax_url,type:"POST",dataType:"json",data:{action:"linkcentral_get_link_data",nonce:linkcentral_tinymce_data.nonce,link_id:t},success:function(n){n.success?i(n.data):(console.error("Error fetching link data:",n.data),i(null))},error:function(n,e,t){console.error("AJAX error:",e,t),i(null)}})),r.addEventListener("input",(n=function(n){var e,t=n.target.value;t.length>=2?(e=t,jQuery.ajax({url:linkcentral_tinymce_data.ajax_url,type:"POST",dataType:"json",data:{action:"linkcentral_tinymce_search_links",nonce:linkcentral_tinymce_data.nonce,search:e},success:function(n){var e,t;n.success?(e=n.data,(t=document.getElementById("linkcentral-search-results"))&&(t.innerHTML="",e.length>0?(e.forEach((function(n){var e=document.createElement("div");e.innerHTML='<span style="font-weight: bold;">'+n.title+'</span> (<span style="font-family:monospace,monospace;font-size:0.9em;vertical-align:middle;">'+n.slug+"</span>)",e.style.padding="5px",e.style.cursor="pointer",e.style.backgroundColor="white",e.addEventListener("mouseover",(function(){this.style.backgroundColor="#f0f0f0"})),e.addEventListener("mouseout",(function(){this.style.backgroundColor="white"})),e.addEventListener("click",(function(){document.getElementById("linkcentral-search").value=n.title,t.style.display="none",o(n)})),t.appendChild(e)})),t.style.display="block"):t.style.display="none")):console.error("Error searching links:",n.data)},error:function(n,e,t){console.error("AJAX error:",e,t)}})):document.getElementById("linkcentral-search-results").style.display="none"},function(){var t=this,a=arguments;clearTimeout(e),e=setTimeout((function(){n.apply(t,a)}),300)})))}),100)}function o(e){n.windowManager.getWindows()[0].selectedLink=JSON.stringify(e)}n.addButton("linkcentral",{title:"Insert LinkCentral Link",image:a,onclick:function(){i(n)},onpostrender:function(){var e=this;n.on("NodeChange",(function(n){e.active("a"===n.element.nodeName.toLowerCase()&&n.element.hasAttribute("data-linkcentral-id-sync"))}))}}),n.on("preinit",(function(){n.wp&&n.wp._createToolbar&&(t=n.wp._createToolbar(["linkcentral_url_display","linkcentral_edit","linkcentral_remove"],!0))})),n.on("wptoolbar",(function(e){var a=n.dom.getParent(e.element,"a[data-linkcentral-id-sync]");a&&(e.element=a,e.toolbar=t,function(n,e){n.lastSelectedLinkNode!==e&&(n.lastSelectedLinkNode=e,setTimeout((function(){for(var n,t=document.querySelectorAll(".mce-inline-toolbar-grp"),a=0;a<t.length;a++)if(null!==t[a].offsetParent){n=t[a];break}if(n){var i=n.querySelector(".linkcentral-url-display");if(i){var o=i.querySelector(".linkcentral-url-display-text"),r=i.querySelector(".linkcentral-url-display-id");o&&(o.innerHTML="Loading preview...");var l=e.getAttribute("data-linkcentral-id-sync");r&&(r.innerHTML='<span style="font-size: 10px; font-weight: bold;">Synchronized with ID: '+l+"</span>"),l&&jQuery.ajax({url:linkcentral_tinymce_data.ajax_url,type:"POST",dataType:"json",data:{action:"linkcentral_get_link_data",nonce:linkcentral_tinymce_data.nonce,link_id:l},success:function(n){if(n.success){var e=n.data,t=linkcentral_tinymce_data.site_url+"/"+linkcentral_tinymce_data.url_prefix+"/"+e.slug,a=linkcentral_tinymce_data.site_url+"/wp-admin/post.php?post="+e.id+"&action=edit";o&&(o.innerHTML='<a href="'+a+'" target="_blank" style="text-decoration: none;">'+t+"</a>")}else o.innerHTML='<span style="color:red;">'+n.data+"</span>",console.error("Error fetching link data:",n.data)},error:function(n,e,t){console.error("AJAX error:",e,t)}})}else console.log("URL display control not found")}else console.log("Active toolbar not found")}),0))}(n,a))})),n.addButton("linkcentral_url_display",{type:"container",onPostRender:function(){this.getEl().innerHTML='<div class="linkcentral-url-display" style="display: flex; align-items: center;"><img src="'+a+'" style="width: 24px; height: 24px; vertical-align: middle; margin-right: 5px;"><div><div class="linkcentral-url-display-text"></div><div class="linkcentral-url-display-id"></div></div></div>'}}),n.addButton("linkcentral_edit",{title:"Edit LinkCentral Link",icon:"dashicon dashicons-edit",onclick:function(){i(n)}}),n.addButton("linkcentral_remove",{title:"Remove LinkCentral Link",icon:"dashicon dashicons-editor-unlink",onclick:function(){n.execCommand("unlink")}}),n.on("init",(function(){var e=n.getDoc().head,t=n.getDoc().createElement("style");t.type="text/css",t.innerHTML="\n                    a[data-linkcentral-id-sync],\n                    a.linkcentral-link {\n                        text-decoration: none;\n                        cursor: pointer;\n                        border-bottom: 2px solid;\n                        border-image: linear-gradient(to right, #12668A, #68C8CB) 1;\n                        display: inline-block;\n                        padding-bottom: 0;\n                        line-height: 1;\n                    }\n                ",e.appendChild(t)}))})),e.editors.length>0&&e.editors.forEach((function(n){n.addCommand("mceLinkCentral",(function(){openLinkCentralModal(n)}))}))):console.log("LinkCentral data not found")}function t(){void 0!==window.tinymce&&window.tinymce.PluginManager?e(window.tinymce):window.addEventListener("tinymce-editor-setup",(function(){e(window.tinymce)}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),void 0!==window.tinymce&&window.tinymce.on("AddEditor",(function(n){n.editor.addCommand("mceLinkCentral",(function(){openLinkCentralModal(n.editor)}))}))}()})();