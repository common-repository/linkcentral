(()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function n(t){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?e(Object(l),!0).forEach((function(e){r(t,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):e(Object(l)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(l,e))}))}return t}function r(e,n,r){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,l,i,o,a=[],c=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){s=!0,l=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw l}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var o=linkcentral_gutenberg_data.plugin_url+"assets/images/linkcentral-logo.svg";(new Image).src=o,function(t){var e=t.richText,r=e.registerFormatType,i=(e.applyFormat,e.removeFormat,t.element),a=i.createElement,c=i.useState,s=i.useEffect,u=i.createPortal,d=i.useRef,p=i.useCallback,f=t.i18n.__,k=t.components,m=k.Modal,b=k.Spinner,g=k.Button,v=k.TextControl,y=k.ToggleControl,h=(t.data.useSelect,t.blockEditor),x=h.URLPopover,w=h.BlockControls;function _(){var t=document.querySelector('iframe[name="editor-canvas"]');return t?t.contentDocument||t.contentWindow.document:document}var C=function(e){var r=l(c(!1),2),i=r[0],k=r[1],h=l(c(""),2),C=h[0],S=h[1],L=l(c([]),2),E=L[0],j=L[1],O=l(c(!1),2),A=O[0],T=O[1],I=l(c(null),2),z=I[0],B=I[1],F=l(c(!1),2),P=F[0],N=F[1],R=l(c(!1),2),D=R[0],U=R[1],W=l(c(null),2),q=W[0],Y=W[1],M=l(c(null),2),H=M[0],X=M[1],$=l(c(null),2),G=$[0],J=$[1],K=l(c({top:0,left:0}),2),Q=K[0],V=K[1],Z=l(c(!1),2),tt=Z[0],et=Z[1],nt=l(c(null),2),rt=nt[0],lt=nt[1],it=l(c(!1),2),ot=it[0],at=it[1],ct=l(c(!1),2),st=ct[0],ut=ct[1],dt=l(c(""),2),pt=dt[0],ft=dt[1],kt=l(c(!1),2),mt=(kt[0],kt[1],l(c((function(){var t=linkcentral_gutenberg_data.default_link_insertion_type||"synchronized";return"core/button"===e.name&&"shortcode"===t?"synchronized":t})),2)),bt=mt[0],gt=mt[1],vt=l(c(!1),2),yt=vt[0],ht=vt[1],xt=l(c(!1),2),wt=(xt[0],xt[1],d(null)),_t=d(null),Ct=l(c(null),2),St=Ct[0],Lt=Ct[1];s((function(){function t(t){St&&!t.target.closest(".".concat(St))&&Lt(null)}return document.addEventListener("mousedown",t),function(){document.removeEventListener("mousedown",t)}}),[St]);var Et=function(t){Lt((function(e){return e===t?null:t}))};s((function(){if(tt&&P)return jt(),window.addEventListener("resize",jt),function(){return window.removeEventListener("resize",jt)}}),[tt,P,jt]);var jt=p((function(){if(_t.current){var t=_t.current.getBoundingClientRect();V({top:t.bottom+window.scrollY,left:t.left+window.scrollX})}}),[]),Ot=p((function(n){J(n),X(null),lt(null),at(!1),S(""),ut(!0),ft(""),t.apiFetch({path:"/wp/v2/linkcentral_link/".concat(n)}).then((function(t){if("publish"===t.status){X(t),lt(t),S(t.title.rendered),B(t);var n=!1;if("core/button"===e.name)n="_blank"===e.attributes.target,ft(e.attributes["data-linkcentral-parameters"]||"");else{var r,l,i=e.value.activeFormats?e.value.activeFormats.find((function(t){return"linkcentral/link"===t.type})):void 0;n="_blank"===(null==i||null===(r=i.attributes)||void 0===r?void 0:r.target),ft((null==i||null===(l=i.attributes)||void 0===l?void 0:l["data-linkcentral-parameters"])||"")}at(n),T(n)}else console.error("Link is not published:",t),X({error:!0})})).catch((function(t){console.error("Error fetching link data:",t),X({error:!0})})).finally((function(){ut(!1)}))}),[e.name,e.attributes,e.value]);s((function(){var t=function(t){var r=_(),l=t.target.closest("a[data-linkcentral-id-sync]"),i=t.target.closest(".linkcentral-popover");if(l){t.preventDefault();var o=l.getAttribute("data-linkcentral-id-sync");Y(l),U(!0),Ot(o)}else!i&&D&&n();if("core/button"===e.name){var a=r.querySelector(".wp-block-button__link");a&&e.attributes["data-linkcentral-id-sync"]&&(Y(a),U(!0),Ot(e.attributes["data-linkcentral-id-sync"]))}},n=function(){U(!1),Y(null),B(null),X(null),J(null),lt(null),at(!1),S(""),ft("")},r=function(){_().removeEventListener("click",t,!0)};return e.isActive&&!i?_().addEventListener("click",t,!0):(n(),r()),function(){return r()}}),[e.isActive,e.name,e.attributes,i,Ot]);var At=function(){B(null),k(!1),U(!1),Y(null),X(null),J(null)};return s((function(){var t=function(){St&&(Lt(null),setTimeout((function(){return Lt(St)}),0))};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[St]),a("div",null,a(w,null,a(t.components.ToolbarButton,{icon:a("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"0 8px"}},a("img",{src:o,alt:"LinkCentral",width:20,height:20,style:{display:"block"}}),e.isActive&&a("span",{},f("Edit","linkcentral"))),title:f("LinkCentral","linkcentral"),onClick:function(){var t,n,r=!i;(k(r),et(r),r&&e.isActive)?(t="core/button"===e.name?e.attributes["data-linkcentral-id-sync"]:null===(n=e.value.activeFormats)||void 0===n||null===(n=n.find((function(t){return"linkcentral/link"===t.type})))||void 0===n?void 0:n.attributes["data-linkcentral-id-sync"])&&Ot(t):r||(N(!1),S(""),j([]),lt(null),at(!1),ft(""))},isActive:e.isActive})),i&&a(m,{title:f(rt?"Edit LinkCentral Link":"Select LinkCentral Link","linkcentral"),onRequestClose:function(){k(!1),et(!1),N(!1),S(""),j([]),lt(null),at(!1),ft(""),ut(!1),gt("synchronized")},style:{minWidth:"420px"}},a("div",null,st?a("div",{style:{textAlign:"center",padding:"20px"}},a(b),a("p",null,f("Loading link data...","linkcentral"))):a(t.element.Fragment,null,a("div",{style:{position:"relative",display:"flex",alignItems:"flex-end"}},a("div",{style:{flex:1,marginRight:"8px"}},a(v,{label:f("Search for a link","linkcentral"),value:C,onChange:function(e){S(e),function(e){e.length>=2?(ht(!0),t.apiFetch({path:"/wp/v2/linkcentral_link?search=".concat(encodeURIComponent(e),"&status=publish")}).then((function(t){tt&&(j(t),N(!0),jt())})).finally((function(){ht(!1)}))):(j([]),N(!1))}(e)},className:"linkcentral-search-input",ref:_t,style:{fontSize:"16px",minHeight:"40px"}})),yt&&a(b,{style:{position:"absolute",right:"48px",top:"50%",transform:"translateY(-50%)"}}),a("div",{ref:wt,style:{position:"relative"}},a(g,{icon:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24},a("path",{d:"m19 7.5h-7.628c-.3089-.87389-1.1423-1.5-2.122-1.5-.97966 0-1.81309.62611-2.12197 1.5h-2.12803v1.5h2.12803c.30888.87389 1.14231 1.5 2.12197 1.5.9797 0 1.8131-.62611 2.122-1.5h7.628z"}),a("path",{d:"m19 15h-2.128c-.3089-.8739-1.1423-1.5-2.122-1.5s-1.8131.6261-2.122 1.5h-7.628v1.5h7.628c.3089.8739 1.1423 1.5 2.122 1.5s1.8131-.6261 2.122-1.5h2.128z"})),label:f("Link Settings","linkcentral"),onClick:function(){return Et("link-settings-popover")},className:"link-settings-popover",style:{marginBottom:"10px"}}),function(){if("link-settings-popover"!==St)return null;var t=document.querySelector(".link-settings-popover");if(!t)return null;var e=t.getBoundingClientRect(),n={position:"absolute",backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px",padding:"16px",width:"200px",zIndex:1e5,boxShadow:"0 2px 5px rgba(0, 0, 0, 0.2)",top:"".concat(e.bottom+window.scrollY,"px"),right:"".concat(window.innerWidth-e.right,"px")};return u(a("div",{style:n,className:"link-settings-popover",onClick:function(t){return t.stopPropagation()}},a(y,{label:f("Open in New Tab","linkcentral"),checked:rt?ot:A,onChange:function(t){rt?at(t):T(t)}}),a("div",{style:{borderTop:"1px solid #ccc",margin:"10px 0"}}),linkcentral_gutenberg_data.can_use_premium_code__premium_only?a(v,{label:f("Parameters","linkcentral"),value:pt,onChange:function(t){return ft(t)},placeholder:f("e.g., param1=value1&param2=value2","linkcentral"),help:f("These will be appended to the link.","linkcentral")}):a("div",{className:"linkcentral-premium-notice"},a("p",{style:{marginBottom:0}},f("Unlock more options with ","linkcentral"),a("a",{href:"admin.php?page=linkcentral-settings#premium",target:"_blank",style:{textDecoration:"underline"}},f("LinkCentral Premium","linkcentral"))))),document.body)}())),a("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"10px"}},a("div",{style:{display:"flex",alignItems:"center"}},a("span",null,f("Insert as:","linkcentral")),a(g,{isTertiary:!0,onClick:function(){return Et("linkcentral-insert-options-popover")},style:{marginLeft:"2px"},className:"linkcentral-insert-options-popover"},a("span",null," ".concat(bt)),a("span",{className:"dashicons dashicons-arrow-down-alt2"}))),a(g,{isPrimary:!0,onClick:function(){if(z){var r=z.id;if(r){var l=t.data.select("core/block-editor").getSelectedBlock(),i=l&&"core/button"===l.name,o=z.title.rendered,a=function(){switch(bt){case"synchronized":return function(t){return n(n({url:"#linkcentral","data-linkcentral-id-sync":t.toString()},rt?ot&&{target:"_blank",rel:"noopener noreferrer"}:A&&{target:"_blank",rel:"noopener noreferrer"}),pt&&{"data-linkcentral-parameters":pt})}(r);case"direct":var t=(o=z.slug,a="".concat(linkcentral_gutenberg_data.site_url,"/").concat(linkcentral_gutenberg_data.url_prefix,"/").concat(o),pt&&(a+=a.includes("?")?"&":"?",a+=pt),n({url:a},rt?ot&&{target:"_blank",rel:"noopener noreferrer"}:A&&{target:"_blank",rel:"noopener noreferrer"})),e=["yes"===z.nofollow||"default"===z.nofollow&&z.global_nofollow?"nofollow":"","yes"===z.sponsored||"default"===z.sponsored&&z.global_sponsored?"sponsored":""].filter(Boolean).join(" ");if(e&&(t.rel=e),!i){var l="replace"===z.css_classes_option?z.custom_css_classes:"".concat(z.global_css_classes||""," ").concat(z.custom_css_classes||"").trim();l&&(t.className=l)}return t;case"shortcode":return function(t){var e='[linkcentral id="'.concat(t,'"');return(rt?ot:A)&&(e+=' newtab="true"'),pt&&(e+=' parameters="'.concat(pt,'"')),e+"]"}(r)}var o,a}();if(i)t.data.dispatch("core/block-editor").updateBlockAttributes(l.clientId,n(n({url:null,"data-linkcentral-id-sync":null,"data-linkcentral-parameters":null,className:null,target:null,rel:null},a),{},{text:l.attributes.text||o}));else{var c=e.value,s=c,u=s.start,d=s.end,p=t.richText.getActiveFormat(c,"core/link")||t.richText.getActiveFormat(c,"linkcentral/link");if(p&&u===d){for(;u>0&&null!==(f=c.formats[u-1])&&void 0!==f&&f.some((function(t){return t.type===p.type}));){var f;u--}for(;d<c.formats.length&&null!==(k=c.formats[d])&&void 0!==k&&k.some((function(t){return t.type===p.type}));){var k;d++}}if(c=t.richText.removeFormat(c,"linkcentral/link",u,d),c=t.richText.removeFormat(c,"core/link",u,d),u===d&&(c=t.richText.insert(c,o,u),d=u+o.length),"shortcode"===bt){var m=c.text.slice(u,d);c=t.richText.insert(c,"".concat(a).concat(m,"[/linkcentral]"),u,d)}else c=t.richText.applyFormat(c,{type:"synchronized"===bt?"linkcentral/link":"core/link",attributes:a},u,d);e.onChange(c)}At(),"direct"!==bt&&"shortcode"!==bt||document.activeElement.blur()}else console.error("ID is undefined. Full selected link object:",z)}},disabled:!z,style:{marginLeft:"auto"}},f(rt?"Update Link":"Apply Link","linkcentral"))),function(){if("linkcentral-insert-options-popover"!==St)return null;var t=document.querySelector(".linkcentral-insert-options-popover");if(!t)return null;var n=t.getBoundingClientRect(),r={position:"absolute",backgroundColor:"#fff",border:"1px solid #ccd0d4",borderRadius:"4px",padding:"8px 8px 0 8px",zIndex:1e5,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",width:"220px",top:"".concat(n.bottom+window.scrollY,"px"),left:"".concat(n.left+window.scrollX,"px")};return u(a("div",{style:r,className:"linkcentral-insert-options-popover",onClick:function(t){return t.stopPropagation()}},a("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",borderBottom:"1px solid #ccd0d4",paddingBottom:"8px"}},a("strong",null,f("Select link type","linkcentral")),a("a",{href:"https://designforwp.com/docs/linkcentral/creating-and-using-links/inserting-links-into-your-content/",target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",textDecoration:"none",color:"#007cba"}},f("What is this?","linkcentral"))),a("ul",{style:{listStyle:"none",padding:0,margin:0}},["synchronized","direct","shortcode"].map((function(t){return a("li",{key:t,onClick:function(){"shortcode"===t&&"core/button"===e.name||(gt(t),Lt(null))},style:{cursor:"shortcode"===t&&"core/button"===e.name?"not-allowed":"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:bt===t?"#f0f0f0":"transparent",opacity:"shortcode"===t&&"core/button"===e.name?.5:1,transition:"background-color 0.3s"},onMouseEnter:function(e){t!==bt&&(e.currentTarget.style.backgroundColor="#e8e8e8")},onMouseLeave:function(e){t!==bt&&(e.currentTarget.style.backgroundColor="transparent")}},a("div",{style:{display:"flex",alignItems:"center"}},a("span",{className:"dashicons ".concat("synchronized"===t?"dashicons-update-alt":"direct"===t?"dashicons-admin-links":"dashicons-shortcode"),style:{fontSize:"20px",marginRight:"8px"}}),a("span",null,f(t.charAt(0).toUpperCase()+t.slice(1),"linkcentral"))),a("span",{style:{fontSize:"10px",color:"#888"}},"shortcode"===t&&"core/button"===e.name?f("Unavailable","linkcentral"):t===linkcentral_gutenberg_data.default_link_insertion_type&&f("Default","linkcentral")))})))),document.body)}()))),P&&0!==E.length?u(a("ul",{style:{position:"absolute",top:"".concat(Q.top,"px"),left:"".concat(Q.left,"px"),zIndex:9999999,backgroundColor:"white",border:"1px solid #ccc",maxHeight:"200px",overflowY:"auto",width:"300px",listStyle:"none",padding:"5px",margin:"0",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}},E.map((function(t){return a("li",{key:t.id,style:{cursor:"pointer",padding:"5px",backgroundColor:z===t?"#e0e0e0":"transparent"},onClick:function(e){e.stopPropagation(),function(t){B(t),S(t.title.rendered),N(!1)}(t)}},a("strong",null,t.title.rendered)," (",t.slug,")")}))),document.body):null,D&&a(x,{anchor:q,onClose:function(){U(!1),Y(null),B(null),X(null),J(null)},className:"linkcentral-popover"},a("div",{style:{padding:"10px",maxWidth:"400px",minWidth:"auto",width:"90vw"},onClick:function(t){t.stopPropagation()}},a("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},a("div",{style:{display:"flex",alignItems:"center"}},a("img",{src:o,alt:"LinkCentral",width:24,height:24,style:{marginRight:"8px"}}),a("div",null,a("div",null,H?H.error?a("span",{style:{color:"red"}},f("Link not found or inactive","linkcentral")):a("a",{href:"".concat(linkcentral_gutenberg_data.site_url,"/wp-admin/post.php?post=").concat(H.id,"&action=edit"),target:"_blank",style:{textDecoration:"none"}},linkcentral_gutenberg_data.site_url+"/"+linkcentral_gutenberg_data.url_prefix+"/"+H.slug):f("Loading...","linkcentral")),a("div",{style:{fontSize:"11px",fontWeight:"bold"}},"Synchronized with ID: "+G))),a(g,{icon:"editor-unlink",label:f("Remove Link","linkcentral"),onClick:function(){var n=t.data.select("core/block-editor").getSelectedBlock();if(n&&"core/button"===n.name)t.data.dispatch("core/block-editor").updateBlockAttributes(n.clientId,{url:null,"data-linkcentral-id-sync":null});else{var r=t.richText.removeFormat(e.value,"linkcentral/link",e.value.start,e.value.end);e.onChange(r)}At()},tabIndex:-1})))))};r("linkcentral/link",{title:f("LinkCentral","linkcentral"),tagName:"a",className:"linkcentral-link",attributes:{url:"href",target:"target",rel:"rel","data-linkcentral-id-sync":"data-linkcentral-id-sync","data-linkcentral-parameters":"data-linkcentral-parameters"},edit:C}),t.hooks.addFilter("editor.BlockEdit","linkcentral/button-toolbar",(function(e){return function(n){return"core/button"===n.name?a(t.element.Fragment,null,a(e,n),a(w,null,a(C,{isActive:!!n.attributes["data-linkcentral-id-sync"],value:n.attributes,onChange:function(t){return n.setAttributes(t)},name:n.name,attributes:n.attributes}))):a(e,n)}})),t.hooks.addFilter("editor.BlockListBlock","linkcentral/button-link-ui",(function(e){return function(n){return"core/button"===n.name&&n.attributes["data-linkcentral-id-sync"]?t.element.createElement(e,Object.assign({},n,{isSelected:!1})):t.element.createElement(e,n)}})),t.hooks.addFilter("blocks.registerBlockType","linkcentral/extend-button-attributes",(function(t,e){return"core/button"===e&&(t.attributes=Object.assign(t.attributes,{"data-linkcentral-id-sync":{type:"string",source:"attribute",selector:"a",attribute:"data-linkcentral-id-sync"},"data-linkcentral-parameters":{type:"string",source:"attribute",selector:"a",attribute:"data-linkcentral-parameters"}})),t})),t.hooks.addFilter("editor.BlockEdit","linkcentral/handle-unlink",(function(t){return function(e){if("core/button"===e.name){var n=e.attributes.url&&e.setAttributes;n&&(e.setAttributes=function(t){t.hasOwnProperty("url")&&!t.url&&(t["data-linkcentral-id-sync"]=void 0),n(t)})}return a(t,e)}})),t.hooks.addFilter("blocks.getSaveElement","linkcentral/button-save",(function(e,n,r){return"core/button"===n.name&&r["data-linkcentral-id-sync"]?t.element.cloneElement(e,{children:t.element.cloneElement(e.props.children,{"data-linkcentral-id-sync":r["data-linkcentral-id-sync"],"data-linkcentral-parameters":r["data-linkcentral-parameters"]})}):e}))}(window.wp)})();